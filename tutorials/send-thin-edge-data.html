<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Send Thin Edge Json data - Thin Edge Book</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../001_overview.html">Overview</a></li><li class="chapter-item expanded "><a href="../tutorials/index.html"><strong aria-hidden="true">1.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorials/connect-c8y.html"><strong aria-hidden="true">1.1.</strong> Connect my device to Cumulocity IoT</a></li><li class="chapter-item expanded "><a href="../tutorials/connect-azure.html"><strong aria-hidden="true">1.2.</strong> Connect my device to Azure IoT</a></li><li class="chapter-item expanded "><a href="../tutorials/send-thin-edge-data.html" class="active"><strong aria-hidden="true">1.3.</strong> Send Thin Edge Json data</a></li><li class="chapter-item expanded "><a href="../tutorials/device-monitoring.html"><strong aria-hidden="true">1.4.</strong> Monitor my device</a></li><li class="chapter-item expanded "><a href="../tutorials/software-management.html"><strong aria-hidden="true">1.5.</strong> Manage my device software</a></li><li class="chapter-item expanded "><a href="../tutorials/write-my-software-management-plugin.html"><strong aria-hidden="true">1.6.</strong> Write my software management plugin</a></li><li class="chapter-item expanded "><a href="../tutorials/supported_operations.html"><strong aria-hidden="true">1.7.</strong> Supported Operations Management for Cumulocity IoT</a></li></ol></li><li class="chapter-item expanded "><a href="../howto-guides/index.html"><strong aria-hidden="true">2.</strong> How-to Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../howto-guides/002_installation.html"><strong aria-hidden="true">2.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../howto-guides/003_registration.html"><strong aria-hidden="true">2.2.</strong> How to create a test certificate</a></li><li class="chapter-item expanded "><a href="../howto-guides/004_connect.html"><strong aria-hidden="true">2.3.</strong> How to connect a cloud end-point</a></li><li class="chapter-item expanded "><a href="../howto-guides/005_pub_sub.html"><strong aria-hidden="true">2.4.</strong> How to send MQTT messages</a></li><li class="chapter-item expanded "><a href="../howto-guides/007_test_connection.html"><strong aria-hidden="true">2.5.</strong> How to test the cloud connection?</a></li><li class="chapter-item expanded "><a href="../howto-guides/008_config_local_mqtt_port.html"><strong aria-hidden="true">2.6.</strong> How to configure the local mqtt port</a></li><li class="chapter-item expanded "><a href="../howto-guides/009_trouble_shooting_monitoring.html"><strong aria-hidden="true">2.7.</strong> How to trouble shoot device monitoring</a></li><li class="chapter-item expanded "><a href="../howto-guides/010_add_self_signed_trusted.html"><strong aria-hidden="true">2.8.</strong> How to add self-signed certificate root to trusted certificates list?</a></li><li class="chapter-item expanded "><a href="../howto-guides/011_retrieve_jwt_token_from_cumulocity.html"><strong aria-hidden="true">2.9.</strong> How to retrieve JWT token from Cumulocity?</a></li><li class="chapter-item expanded "><a href="../howto-guides/012_install_and_enable_software_management.html"><strong aria-hidden="true">2.10.</strong> How to install and enable software management?</a></li><li class="chapter-item expanded "><a href="../howto-guides/013_connect_external_device.html"><strong aria-hidden="true">2.11.</strong> How to connect an external device?</a></li><li class="chapter-item expanded "><a href="../howto-guides/014_thin_edge_logs.html"><strong aria-hidden="true">2.12.</strong> How to access the logs on the device?</a></li><li class="chapter-item expanded "><a href="../howto-guides/015_installation_without_deb_support.html"><strong aria-hidden="true">2.13.</strong> How to install thin-edge.io on any Linux OS (no deb support)?</a></li><li class="chapter-item expanded "><a href="../howto-guides/016_restart_device_operation.html"><strong aria-hidden="true">2.14.</strong> How to restart your thin-edge.io device</a></li></ol></li><li class="chapter-item expanded "><a href="../references/index.html"><strong aria-hidden="true">3.</strong> Reference Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../references/tedge.html"><strong aria-hidden="true">3.1.</strong> The tedge command</a></li><li class="chapter-item expanded "><a href="../references/tedge-config.html"><strong aria-hidden="true">3.2.</strong> The tedge config command</a></li><li class="chapter-item expanded "><a href="../references/tedge-cert.html"><strong aria-hidden="true">3.3.</strong> The tedge cert command</a></li><li class="chapter-item expanded "><a href="../references/tedge-connect.html"><strong aria-hidden="true">3.4.</strong> The tedge connect command</a></li><li class="chapter-item expanded "><a href="../references/tedge-disconnect.html"><strong aria-hidden="true">3.5.</strong> The tedge disconnect command</a></li><li class="chapter-item expanded "><a href="../references/tedge-mqtt.html"><strong aria-hidden="true">3.6.</strong> The tedge mqtt command</a></li><li class="chapter-item expanded "><a href="../references/bridged-topics.html"><strong aria-hidden="true">3.7.</strong> The Bridged Topics</a></li><li class="chapter-item expanded "><a href="../references/plugin-api.html"><strong aria-hidden="true">3.8.</strong> The Software Management Plugin API</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/index.html"><strong aria-hidden="true">4.</strong> Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/thin-edge-json.html"><strong aria-hidden="true">4.1.</strong> Thin Edge Json</a></li><li class="chapter-item expanded "><a href="../architecture/mapper.html"><strong aria-hidden="true">4.2.</strong> The Mapper</a></li><li class="chapter-item expanded "><a href="../architecture/software-management.html"><strong aria-hidden="true">4.3.</strong> Software Management</a></li><li class="chapter-item expanded "><a href="../architecture/faq.html"><strong aria-hidden="true">4.4.</strong> Architecture FAQ</a></li><li class="chapter-item expanded "><a href="../supported-platforms.html"><strong aria-hidden="true">4.5.</strong> Platform support</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Thin Edge Book</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="send-thin-edge-json-data"><a class="header" href="#send-thin-edge-json-data">Send Thin Edge JSON data</a></h1>
<p>Once your Thin Edge device is configured and connected to an IoT cloud provider, you can start sending measurements.
Refer to <a href="../tutorials/connect-c8y.html">Connecting to Cumulocity</a> or tutorials for other cloud providers 
to learn how to connect your Thin Edge device to an IoT cloud provider. </p>
<p>In this tutorial, we'll see how different kinds of measurements are represented in Thin Edge JSON format and 
how they can be sent to the connected cloud provider.
For a more detailed specification of this data format, refer to <a href="../architecture/thin-edge-json.html">Thin Edge JSON Specification</a>.</p>
<h2 id="sending-measurements"><a class="header" href="#sending-measurements">Sending measurements</a></h2>
<p>A simple single-valued measurement like a temperature measurement, can be represented in Thin Edge JSON as follows:</p>
<pre><code class="language-json">{ &quot;temperature&quot;: 25 }
</code></pre>
<p>with the key-value pair representing the measurement type and the numeric value of the measurement.</p>
<p>This measurement can be sent from the Thin Edge device to the cloud by publishing this message to the <code>tedge/measurements</code> MQTT topic.
Processes running on the Thin Edge device can publish messages to the local MQTT broker using any MQTT client or library.
In this tutorial, we'll be using the <code>tedge mqtt pub</code> command line utility for demonstration purposes.</p>
<p>The temperature measurement described above can be sent using the <code>tedge mqtt pub</code> command as follows:</p>
<pre><code class="language-shell">$ tedge mqtt pub tedge/measurements '{ &quot;temperature&quot;: 25 }'
</code></pre>
<p>The first argument to the <code>tedge mqtt pub</code> command is the topic to which the measurements must be published to.
The second argument is the Thin Edge JSON representation of the measurement itself.</p>
<p>When connected to a cloud provider, a message mapper component for that cloud provider would be running as a daemon, 
listening to any measurements published to <code>tedge/measurements</code>.
The mapper, on receipt of these Thin Edge JSON measurements, will map those measurements to their equivalent
cloud provider native representation and send it to that cloud.</p>
<p>For example, when the device is connected to Cumulocity, the Cumulocity mapper component will be performing these actions.
To check if these measurements have reached Cumulocity, login to your Cumulocity dashboard and navigate to
<em>Device Management =&gt; Devices =&gt; All devices =&gt; <your device id> =&gt; Measurements</em> 
and see if your temperature measurement is appearing in the dashboard.</p>
<h2 id="complex-measurements"><a class="header" href="#complex-measurements">Complex measurements</a></h2>
<p>You can represent measurements that are far more complex than the single-valued ones described above using the Thin Edge JSON format.</p>
<p>A multi-valued measurement like <code>three_phase_current</code> that consists of <code>L1</code>, <code>L2</code> and <code>L3</code> values,
representing the current on each phase can be represented as follows:</p>
<pre><code class="language-json">{
  &quot;three_phase_current&quot;: {
    &quot;L1&quot;: 9.5,
    &quot;L2&quot;: 10.3,
    &quot;L3&quot;: 8.8
  }
}
</code></pre>
<p>Here is another complex message consisting of single-valued measurements: <code>temperature</code> and <code>pressure</code> 
along with a multi-valued <code>coordinate</code> measurement, all sharing a single timestamp captured as <code>time</code>.</p>
<pre><code class="language-json">{
  &quot;time&quot;: &quot;2020-10-15T05:30:47+00:00&quot;,
  &quot;temperature&quot;: 25,
  &quot;current&quot;: {
    &quot;L1&quot;: 9.5,
    &quot;L2&quot;: 10.3,
    &quot;L3&quot;: 8.8
  },
  &quot;pressure&quot;: 98
}
</code></pre>
<p>The <code>time</code> field is not a regular measurement like <code>temperature</code> or <code>pressure</code> but a special reserved field.
Refer to <a href="../architecture/thin-edge-json.html">Thin Edge JSON Specification</a> for more details on the kinds of telemetry 
data that can be represented in Thin Edge JSON format and the reserved fields like <code>time</code> used in the above example.</p>
<h2 id="sending-measurements-to-child-devices"><a class="header" href="#sending-measurements-to-child-devices">Sending measurements to child devices</a></h2>
<blockquote>
<p>Note: Currently this feature supports Cumulocity IoT only.</p>
</blockquote>
<p>If valid Thin Edge JSON measurements are published to the <code>tedge/measurements/&lt;child-id&gt;</code> topic,
the measurements are recorded under a child device of your thin-edge.io device.</p>
<p>Given your desired child device ID is <code>child1</code>, publish a Thin Edge JSON message to the <code>tedge/measurements/child1</code> topic:</p>
<pre><code class="language-shell">$ tedge mqtt pub tedge/measurements/child1 '{ &quot;temperature&quot;: 25 }'
</code></pre>
<p>Then, you will see a child device with the name <code>child1</code> is created in your Cumulocity IoT tenant,
and the measurement is recorded in <code>Measurements</code> of the <code>child1</code> device.</p>
<h2 id="error-detection"><a class="header" href="#error-detection">Error detection</a></h2>
<p>If the data published to the <code>tedge/measurements</code> topic are not valid Thin Edge JSON measurements, those won't be
sent to the cloud but instead you'll get a feedback on the <code>tedge/errors</code> topic, if you subscribe to it.
The error messages published to this topic will be highly verbose and may change in the future.
So, use it only for debugging purposes during the development phase and it should <strong>not</strong> be used for any automation.</p>
<p>You can use the <code>tedge mqtt sub</code> command to subscribe to the error topic as follows:</p>
<pre><code class="language-shell">$ tedge mqtt sub tedge/errors
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../tutorials/connect-azure.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../tutorials/device-monitoring.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../tutorials/connect-azure.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../tutorials/device-monitoring.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
